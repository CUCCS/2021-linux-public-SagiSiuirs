# 实验报告三


### 实验环境

- Ubuntu 20.04
- Virtual Box 6.1

### 实验要求

- 阅读阮一峰的「Systemd 入门教程：命令篇」与「Systemd 入门教程：实战篇」并进行动手实操。录屏上传到asciinema。
- 完成课后自查清单


### 实验过程

#### 第一篇：命令篇
- [阮一峰的网络日志 Systemd 入门教程：命令篇](http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html)

1. 由来
[![asciicast](https://asciinema.org/a/IRXsuR5mWaRDMl4DR0KKG3pzv.svg)](https://asciinema.org/a/IRXsuR5mWaRDMl4DR0KKG3pzv)
2. Systemd概述
[![asciicast](https://asciinema.org/a/hQX2oAu3DH3gGMxbAHG4EEAoN.svg)](https://asciinema.org/a/hQX2oAu3DH3gGMxbAHG4EEAoN)
3. 系统管理
[![asciicast](https://asciinema.org/a/7xahqhial5NcWrrcGAXrC8AYO.svg)](https://asciinema.org/a/7xahqhial5NcWrrcGAXrC8AYO)
4. Unit
[![asciicast](https://asciinema.org/a/jU4eySGUXWBrlDEnf7XQ8qPzE.svg)](https://asciinema.org/a/jU4eySGUXWBrlDEnf7XQ8qPzE)
5. Unit的配置文件
[![asciicast](https://asciinema.org/a/CUGxqBBa7sM7K1TDFh04sqhTq.svg)](https://asciinema.org/a/CUGxqBBa7sM7K1TDFh04sqhTq)
6. Target
[![asciicast](https://asciinema.org/a/ArsNveBStcZi4VzWKoMdL177a.svg)](https://asciinema.org/a/ArsNveBStcZi4VzWKoMdL177a)
7. 日志管理
[![asciicast](https://asciinema.org/a/k0Nebp2SNLoadzxyRjd6Dat4M.svg)](https://asciinema.org/a/k0Nebp2SNLoadzxyRjd6Dat4M)

#### 第二篇：实战篇
- [阮一峰的网络日志 Systemd 入门教程：实战篇](http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-part-two.html)

[![asciicast](https://asciinema.org/a/gwSHqx1gg3FdcOydMTm2UZBIL.svg)](https://asciinema.org/a/gwSHqx1gg3FdcOydMTm2UZBIL)



### 自查清单

1. 如何添加一个用户并使其具备sudo执行程序的权限？
      ```linux
    sudo adduser username  
    sudo usermod -G sudo -a username
    ```

2. 如何将一个用户添加到一个用户组？
      ```linux
    usermod -a -G groupname username
    ```

3. 如何查看当前系统的分区表和文件系统详细信息？

   - df -hT 只可以查看已经挂载的分区和文件系统类型。
   - fdisk -l 可以显示出所有挂载和未挂载的分区，但不显示文件系统类型。
   - gdisk -l 同样可以显示出所有挂载和未挂载的分区，但不显示文件系统类型。
   - parted -l 可以查看未挂载的文件系统类型，以及哪些分区尚未格式化。大于2TB分区支持使用此
   - lsblk -f 也可以查看未挂载的文件系统类型

4. 如何实现开机自动挂载Virtualbox的共享目录分区？

   - 创建一个共享文件夹的挂载目录：`mkdir /mnt/share`
   - 用以下命令实现挂载：`mount-t vboxsf share_file_name /mnt/share`
   - 进入/etc/fstab进行编辑：`share_file_name /mnt/share vboxsf default 0 0`

5. 基于LVM（逻辑分卷管理）的分区如何实现动态扩容和缩减容量？

   - 创建分区并修改为LVM模式：` fdisk 分区名`
   - 动态扩容：`lvextend -L {{size}}`
   - 缩减容量：`lvreduce -L {{size}}`

6. 如何通过systemd设置实现在网络连通时运行一个指定脚本，在网络断开时运行另一个脚本？

   - 修改systemd-networkd中的Service
   - ExecStartPost=网络连通时运行的指定脚本
   - ExecStopPost=网络断开时运行的另一个脚本

7. 如何通过systemd设置实现一个脚本在任何情况下被杀死之后会立即重新启动，实现杀不死？
   ```linux
    sudo systemctl vi scriptname
    restart = always
    sudo systemctl daemon-reload
    ```


### 问题及解决

1. 在线安装需要的软件：sudo apt-get install
2. 没有解决httpd的配置问题，无法运行，用其他进程替代演示